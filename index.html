<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CES 2026 Â±ïÂïÜËøΩËπ§Á≥ªÁµ± | Exhibitor Tracking System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2563eb;
            --secondary-color: #7c3aed;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --star-color: #fbbf24;
            --xfactor-color: #8b5cf6;
            --dark: #1e293b;
            --light: #f8fafc;
            --border: #e2e8f0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        /* È†≠ÈÉ® */
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
        }

        .header-actions {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .lang-switch, .add-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .lang-switch:hover, .add-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        .import-btn {
            background: linear-gradient(135deg, #059669, #047857);
            border: 2px solid #10b981;
        }

        .import-btn:hover {
            background: linear-gradient(135deg, #047857, #065f46);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        .export-btn {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .export-btn:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16,185,129,0.4);
        }

        /* Áµ±Ë®àÂç°Áâá */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 20px;
            padding: 30px;
            background: var(--light);
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 4px solid var(--primary-color);
        }

        .stat-card h3 {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 8px;
        }

        .stat-card .number {
            font-size: 32px;
            font-weight: 700;
            color: var(--dark);
        }

        /* ‰∏ªË¶ÅÂÖßÂÆπÂçÄ */
        .main-content {
            display: flex;
            gap: 20px;
            padding: 30px;
        }

        /* ÂÅ¥ÈÇäÊ¨Ñ */
        .sidebar {
            width: 280px;
            flex-shrink: 0;
        }

        .sidebar h3 {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--dark);
        }

        .venue-list {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .venue-item {
            padding: 15px 20px;
            cursor: pointer;
            border-bottom: 1px solid var(--border);
            transition: all 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .venue-item:hover {
            background: var(--light);
        }

        .venue-item.active {
            background: var(--primary-color);
            color: white;
        }

        .venue-badge {
            background: var(--light);
            color: var(--dark);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .venue-item.active .venue-badge {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        /* Â±ïÂïÜÂàóË°®ÂçÄ */
        .exhibitors-area {
            flex: 1;
            min-width: 0;
        }

        .search-box {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .search-input {
            width: 100%;
            padding: 12px 20px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37,99,235,0.1);
        }

        .exhibitors-list {
            display: grid;
            gap: 20px;
        }

        .exhibitor-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s;
            position: relative;
        }

        .exhibitor-card:hover {
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }

        .exhibitor-card.vip {
            border: 2px solid var(--star-color);
            box-shadow: 0 4px 16px rgba(251,191,36,0.2);
        }

        .exhibitor-card.xfactor {
            border: 2px solid var(--xfactor-color);
            box-shadow: 0 4px 16px rgba(139,92,246,0.2);
        }

        .exhibitor-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 16px;
            gap: 20px;
        }

        .exhibitor-info {
            flex: 1;
            min-width: 0;
        }

        .exhibitor-name-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }

        .star-toggle {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            padding: 0;
            line-height: 1;
            transition: all 0.3s;
            user-select: none;
        }

        .star-toggle:hover {
            transform: scale(1.2);
        }

        .star-toggle.active {
            color: var(--star-color);
            text-shadow: 0 0 10px rgba(251,191,36,0.5);
        }

        .star-toggle:not(.active) {
            color: #cbd5e1;
        }

        .exhibitor-name {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark);
            word-wrap: break-word;
            flex: 1;
        }

        .vip-badge {
            display: none;
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 700;
            box-shadow: 0 2px 8px rgba(251,191,36,0.3);
        }

        .exhibitor-card.vip .vip-badge {
            display: inline-block;
        }

        .xfactor-badge {
            display: none;
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 700;
            box-shadow: 0 2px 8px rgba(139,92,246,0.3);
        }

        .exhibitor-card.xfactor .xfactor-badge {
            display: inline-block;
        }

        .exhibitor-details {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            color: #64748b;
            font-size: 14px;
        }

        .exhibitor-details span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .status-selector {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .status-btn {
            padding: 8px 16px;
            border: 2px solid var(--border);
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .status-btn:hover {
            transform: translateY(-2px);
        }

        .status-btn.not-visited {
            border-color: #cbd5e1;
            color: #64748b;
        }

        .status-btn.not-visited.active {
            background: #cbd5e1;
            color: white;
        }

        .status-btn.visited {
            border-color: var(--success-color);
            color: var(--success-color);
        }

        .status-btn.visited.active {
            background: var(--success-color);
            color: white;
        }

        .status-btn.follow-up {
            border-color: var(--warning-color);
            color: var(--warning-color);
        }

        .status-btn.follow-up.active {
            background: var(--warning-color);
            color: white;
        }

        .status-btn.no-interest {
            border-color: var(--danger-color);
            color: var(--danger-color);
        }

        .status-btn.no-interest.active {
            background: var(--danger-color);
            color: white;
        }

        .notes-section {
            margin-top: 16px;
        }

        .notes-input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            min-height: 80px;
        }

        .notes-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .exhibitor-actions {
            margin-top: 12px;
            display: flex;
            gap: 8px;
        }

        .edit-btn, .delete-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .edit-btn {
            background: var(--primary-color);
            color: white;
        }

        .delete-btn {
            background: var(--danger-color);
            color: white;
        }

        .edit-btn:hover, .delete-btn:hover {
            transform: translateY(-1px);
        }

        /* ÂΩàÁ™óÊ®£Âºè */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 16px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border);
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 30px;
            cursor: pointer;
            color: #64748b;
            transition: all 0.3s;
        }

        .close-btn:hover {
            color: var(--danger-color);
            transform: scale(1.2);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
            transition: all 0.3s;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37,99,235,0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid var(--border);
        }

        .btn-primary, .btn-secondary {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 16px;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37,99,235,0.4);
        }

        .btn-secondary {
            background: #64748b;
            color: white;
        }

        .btn-secondary:hover {
            background: #475569;
            transform: translateY(-2px);
        }

        /* ÈüøÊáâÂºèË®≠Ë®à */
        @media (max-width: 1024px) {
            .main-content {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
            }

            .venue-list {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }

            .venue-item {
                border-right: 1px solid var(--border);
                border-bottom: none;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 22px;
            }

            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }

            .exhibitor-header {
                flex-direction: column;
            }

            .status-selector {
                width: 100%;
            }

            .status-btn {
                flex: 1;
                text-align: center;
            }

            .star-toggle {
                font-size: 24px;
            }

            .modal-content {
                margin: 10% auto;
                padding: 20px;
                width: 95%;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            .header {
                padding: 20px;
            }

            .main-content {
                padding: 15px;
            }

            .stats-container {
                padding: 15px;
                grid-template-columns: 1fr;
            }
        }

        /* ËºâÂÖ•ÂãïÁï´ */
        .loading {
            text-align: center;
            padding: 60px;
            color: #64748b;
        }

        .spinner {
            border: 4px solid var(--border);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    
        /* ÂåØÂÖ•Ê®°ÊÖãÊ°ÜÊ®£Âºè */
        .file-upload-area {
            border: 2px dashed var(--border);
            border-radius: 8px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8fafc;
            margin: 15px 0;
        }

        .file-upload-area:hover {
            border-color: var(--primary-color);
            background: #f1f5f9;
        }

        .file-upload-area.dragover {
            border-color: var(--success-color);
            background: #f0fdf4;
        }

        .upload-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .file-info {
            font-size: 0.85em;
            color: #64748b;
            margin-top: 5px;
        }

        .import-section, .import-options {
            margin: 20px 0;
        }

        .checkbox-label {
            display: block;
            margin: 10px 0;
            cursor: pointer;
        }

        .checkbox-label input[type="checkbox"] {
            margin-right: 8px;
        }

        #filePreview {
            margin-top: 20px;
            padding: 15px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        #previewContent {
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.85em;
            background: white;
            padding: 10px;
            border-radius: 4px;
        }

        .import-progress {
            margin: 15px 0;
            padding: 10px;
            background: #f0f9ff;
            border-radius: 8px;
            border: 1px solid #bae6fd;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e2e8f0;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--success-color));
            width: 0%;
            transition: width 0.3s ease;
        }</style>
</head>
<body>
    <div class="container">
        <!-- È†≠ÈÉ® -->
        <div class="header">
            <h1 id="pageTitle">CES 2026 Â±ïÂïÜËøΩËπ§Á≥ªÁµ±</h1>
            <div class="header-actions">
                <button class="add-btn" onclick="openAddModal()">
                    <span>‚ûï</span>
                    <span id="addText">Êñ∞Â¢ûÂ±ïÂïÜ</span>
                </button>
                <button class="import-btn" onclick="showImportModal()">
                    <span>üì•</span>
                    <span data-zh="ÂåØÂÖ•ËøΩËπ§Á¥ÄÈåÑ" data-en="Import Records">ÂåØÂÖ•ËøΩËπ§Á¥ÄÈåÑ</span>
                </button>
                <button class="lang-switch" onclick="toggleLanguage()">
                    <span id="langText">EN</span>
                </button>
                <button class="export-btn" onclick="exportToExcel()">
                    <span>üìä</span>
                    <span id="exportText">ÂåØÂá∫ Excel</span>
                </button>
            </div>
        </div>

        <!-- Áµ±Ë®àÂç°Áâá -->
        <div class="stats-container">
            <div class="stat-card">
                <h3 id="statTotal">Á∏ΩÂ±ïÂïÜÊï∏</h3>
                <div class="number" id="totalCount">0</div>
            </div>
            <div class="stat-card" style="border-left-color: var(--star-color)">
                <h3 id="statVIP">‚≠ê ÈáçÈªûÂÆ¢Êà∂</h3>
                <div class="number" id="vipCount" style="color: var(--star-color)">0</div>
            </div>
            <div class="stat-card" style="border-left-color: var(--xfactor-color)">
                <h3 id="statXFactor">üéØ X-Factor</h3>
                <div class="number" id="xfactorCount" style="color: var(--xfactor-color)">0</div>
            </div>
            <div class="stat-card" style="border-left-color: var(--success-color)">
                <h3 id="statVisited">Â∑≤ÊãúË®™</h3>
                <div class="number" id="visitedCount" style="color: var(--success-color)">0</div>
            </div>
            <div class="stat-card" style="border-left-color: var(--warning-color)">
                <h3 id="statFollowUp">ÂæÖË∑üÈÄ≤</h3>
                <div class="number" id="followUpCount" style="color: var(--warning-color)">0</div>
            </div>
            <div class="stat-card" style="border-left-color: var(--danger-color)">
                <h3 id="statNoInterest">ÁÑ°ËààË∂£</h3>
                <div class="number" id="noInterestCount" style="color: var(--danger-color)">0</div>
            </div>
        </div>

        <!-- ‰∏ªË¶ÅÂÖßÂÆπ -->
        <div class="main-content">
            <!-- ÂÅ¥ÈÇäÊ¨Ñ - Â†¥È§®ÂàóË°® -->
            <div class="sidebar">
                <h3 id="venueTitle">Â†¥È§®ÂàóË°®</h3>
                <div class="venue-list" id="venueList">
                    <!-- ÂãïÊÖãÁîüÊàê -->
                </div>
            </div>

            <!-- Â±ïÂïÜÂàóË°®ÂçÄ -->
            <div class="exhibitors-area">
                <div class="search-box">
                    <input 
                        type="text" 
                        class="search-input" 
                        id="searchInput"
                        placeholder="ÊêúÂ∞ãÂ±ïÂïÜÂêçÁ®±„ÄÅÂ±ï‰ΩçËôü„ÄÅÂúãÂÆ∂..."
                        oninput="filterExhibitors()"
                    >
                </div>
                <div class="exhibitors-list" id="exhibitorsList">
                    <div class="loading">
                        <div class="spinner"></div>
                        <div id="loadingText">ËºâÂÖ•‰∏≠...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Êñ∞Â¢û/Á∑®ËºØÂ±ïÂïÜÂΩàÁ™ó -->
    <div id="exhibitorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Êñ∞Â¢ûÂ±ïÂïÜ</h2>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            
            <form id="exhibitorForm">
                <div class="form-group">
                    <label class="form-label" id="labelName">Â±ïÂïÜÂêçÁ®± *</label>
                    <input type="text" id="formName" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" id="labelBooth">Â±ï‰ΩçËôüÁ¢º</label>
                    <input type="text" id="formBooth" class="form-input">
                </div>
                
                <div class="form-group">
                    <label class="form-label" id="labelHall">Â†¥È§®</label>
                    <select id="formHall" class="form-select">
                        <option value="X-Factor">üéØ X-Factor</option>
                        <option value="Venetian Expo - Hall G">Venetian Expo - Hall G</option>
                        <option value="Venetian Expo - Halls A-D">Venetian Expo - Halls A-D</option>
                        <option value="LVCC - South Hall">LVCC - South Hall</option>
                        <option value="LVCC - North Hall">LVCC - North Hall</option>
                        <option value="LVCC - Central Hall">LVCC - Central Hall</option>
                        <option value="LVCC - West Hall">LVCC - West Hall</option>
                        <option value="ARIA">ARIA</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label" id="labelCountry">ÂúãÂÆ∂</label>
                    <input type="text" id="formCountry" class="form-input">
                </div>
                
                <div class="form-group">
                    <label class="form-label" id="labelCategory">Áî¢ÂìÅÈ°ûÂà•</label>
                    <input type="text" id="formCategory" class="form-input">
                </div>
                
                <div class="form-group">
                    <label class="form-label" id="labelWebsite">Á∂≤Á´ô</label>
                    <input type="url" id="formWebsite" class="form-input">
                </div>
                
                <div class="form-group">
                    <label class="form-label" id="labelContact">ËÅØÁµ°Ë≥áË®ä</label>
                    <textarea id="formContact" class="form-textarea"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label" id="labelAbout">ÂÖ¨Âè∏Á∞°‰ªã</label>
                    <textarea id="formAbout" class="form-textarea"></textarea>
                </div>
            </form>
            
            <div class="modal-actions">
                <button type="button" class="btn-secondary" onclick="closeModal()" id="cancelBtn">ÂèñÊ∂à</button>
                <button type="button" class="btn-primary" onclick="saveExhibitor()" id="saveBtn">‰øùÂ≠ò</button>
            </div>
        </div>
    </div>

    <script>
        // Â±ïÂïÜÊï∏Êìö
        
        // Â±ïÂïÜÊï∏Êìö (ÂæûÂ§ñÈÉ® JSON ËºâÂÖ•)
        let exhibitorsData = [];
        
        // ËºâÂÖ•Â±ïÂïÜÊï∏Êìö
        async function loadExhibitorsData() {
            try {
                const response = await fetch('exhibitors-data.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                exhibitorsData = await response.json();
                console.log(`‚úÖ ÊàêÂäüËºâÂÖ• ${exhibitorsData.length} Á≠ÜÂ±ïÂïÜÊï∏Êìö`);
                
                // Êï∏ÊìöËºâÂÖ•ÂÆåÊàêÂæåÂàùÂßãÂåñÈ†ÅÈù¢
                init();
            } catch (error) {
                console.error('‚ùå ËºâÂÖ•Â±ïÂïÜÊï∏ÊìöÂ§±Êïó:', error);
                alert(currentLang === 'zh' ? 
                    'ÁÑ°Ê≥ïËºâÂÖ•Â±ïÂïÜÊï∏ÊìöÔºåË´ãÊ™¢Êü•Á∂≤Ë∑ØÈÄ£Á∑öÊàñËÅØÁπ´ÁÆ°ÁêÜÂì°„ÄÇ' : 
                    'Failed to load exhibitor data. Please check your connection or contact admin.');
            }
        }
        
        // È†ÅÈù¢ËºâÂÖ•ÊôÇÂÖàËºâÂÖ•Êï∏Êìö
        window.onload = loadExhibitorsData;

        // Ëá™ÂÆöÁæ©Â±ïÂïÜÊï∏Êìö
        let customExhibitors = JSON.parse(localStorage.getItem('customExhibitors') || '[]');

        // Ë™ûË®ÄÈÖçÁΩÆ
        const translations = {
            zh: {
                pageTitle: 'CES 2026 Â±ïÂïÜËøΩËπ§Á≥ªÁµ±',
                langText: 'EN',
                addText: 'Êñ∞Â¢ûÂ±ïÂïÜ',
                exportText: 'ÂåØÂá∫ Excel',
                statTotal: 'Á∏ΩÂ±ïÂïÜÊï∏',
                statVIP: '‚≠ê ÈáçÈªûÂÆ¢Êà∂',
                statXFactor: 'üéØ X-Factor',
                statVisited: 'Â∑≤ÊãúË®™',
                statFollowUp: 'ÂæÖË∑üÈÄ≤',
                statNoInterest: 'ÁÑ°ËààË∂£',
                venueTitle: 'Â†¥È§®ÂàóË°®',
                searchPlaceholder: 'ÊêúÂ∞ãÂ±ïÂïÜÂêçÁ®±„ÄÅÂ±ï‰ΩçËôü„ÄÅÂúãÂÆ∂...',
                loadingText: 'ËºâÂÖ•‰∏≠...',
                allVenues: 'ÂÖ®ÈÉ®Â†¥È§®',
                statusNotVisited: 'Êú™ÊãúË®™',
                statusVisited: 'Â∑≤ÊãúË®™',
                statusFollowUp: 'ÂæÖË∑üÈÄ≤',
                statusNoInterest: 'ÁÑ°ËààË∂£',
                notesPlaceholder: 'Ë®òÈåÑÊúÉË≠∞ÂÇôË®ª„ÄÅËÅØÁµ°Ë≥áË®ä...',
                booth: 'Â±ï‰Ωç',
                country: 'ÂúãÂÆ∂',
                category: 'È°ûÂà•',
                vipBadge: 'ÈáçÈªûÂÆ¢Êà∂',
                xfactorBadge: 'X-Factor',
                modalTitleAdd: 'Êñ∞Â¢ûÂ±ïÂïÜ',
                modalTitleEdit: 'Á∑®ËºØÂ±ïÂïÜ',
                labelName: 'Â±ïÂïÜÂêçÁ®± *',
                labelBooth: 'Â±ï‰ΩçËôüÁ¢º',
                labelHall: 'Â†¥È§®',
                labelCountry: 'ÂúãÂÆ∂',
                labelCategory: 'Áî¢ÂìÅÈ°ûÂà•',
                labelWebsite: 'Á∂≤Á´ô',
                labelContact: 'ËÅØÁµ°Ë≥áË®ä',
                labelAbout: 'ÂÖ¨Âè∏Á∞°‰ªã',
                cancelBtn: 'ÂèñÊ∂à',
                saveBtn: '‰øùÂ≠ò',
                editBtn: 'Á∑®ËºØ',
                deleteBtn: 'Âà™Èô§',
                deleteConfirm: 'Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄôÂÄãÂ±ïÂïÜÂóéÔºü'
            },
            en: {
                pageTitle: 'CES 2026 Exhibitor Tracking System',
                langText: '‰∏≠Êñá',
                addText: 'Add Exhibitor',
                exportText: 'Export Excel',
                statTotal: 'Total Exhibitors',
                statVIP: '‚≠ê VIP Clients',
                statXFactor: 'üéØ X-Factor',
                statVisited: 'Visited',
                statFollowUp: 'Follow Up',
                statNoInterest: 'No Interest',
                venueTitle: 'Venue List',
                searchPlaceholder: 'Search exhibitor name, booth, country...',
                loadingText: 'Loading...',
                allVenues: 'All Venues',
                statusNotVisited: 'Not Visited',
                statusVisited: 'Visited',
                statusFollowUp: 'Follow Up',
                statusNoInterest: 'No Interest',
                notesPlaceholder: 'Meeting notes, contact info...',
                booth: 'Booth',
                country: 'Country',
                category: 'Category',
                vipBadge: 'VIP Client',
                xfactorBadge: 'X-Factor',
                modalTitleAdd: 'Add Exhibitor',
                modalTitleEdit: 'Edit Exhibitor',
                labelName: 'Exhibitor Name *',
                labelBooth: 'Booth Number',
                labelHall: 'Hall',
                labelCountry: 'Country',
                labelCategory: 'Category',
                labelWebsite: 'Website',
                labelContact: 'Contact Info',
                labelAbout: 'About',
                cancelBtn: 'Cancel',
                saveBtn: 'Save',
                editBtn: 'Edit',
                deleteBtn: 'Delete',
                deleteConfirm: 'Are you sure to delete this exhibitor?'
            }
        };

        // Áï∂ÂâçË™ûË®Ä
        let currentLang = localStorage.getItem('language') || 'zh';

        // ÁãÄÊÖãÊï∏Êìö
        let trackingData = JSON.parse(localStorage.getItem('trackingData') || '{}');

        // Áï∂ÂâçÈÅ∏‰∏≠ÁöÑÂ†¥È§®
        let selectedVenue = 'all';

        // Á∑®ËºØÊ®°Âºè
        let editMode = false;
        let editingId = null;

        // Áç≤ÂèñÊâÄÊúâÂ±ïÂïÜÊï∏ÊìöÔºàÂéüÂßã + Ëá™ÂÆöÁæ©Ôºâ
        function getAllExhibitors() {
            return [...exhibitorsData, ...customExhibitors];
        }

        // ÂàùÂßãÂåñ
        function init() {
            updateLanguage();
            renderVenueList();
            renderExhibitors();
            updateStats();
        }

        // ÂàáÊèõË™ûË®Ä
        function toggleLanguage() {
            currentLang = currentLang === 'zh' ? 'en' : 'zh';
            localStorage.setItem('language', currentLang);
            updateLanguage();
            renderVenueList();
            renderExhibitors();
        }

        // Êõ¥Êñ∞Ë™ûË®ÄÈ°ØÁ§∫
        function updateLanguage() {
            const t = translations[currentLang];
            document.getElementById('pageTitle').textContent = t.pageTitle;
            document.getElementById('langText').textContent = t.langText;
            document.getElementById('addText').textContent = t.addText;
            document.getElementById('exportText').textContent = t.exportText;
            document.getElementById('statTotal').textContent = t.statTotal;
            document.getElementById('statVIP').innerHTML = t.statVIP;
            document.getElementById('statXFactor').innerHTML = t.statXFactor;
            document.getElementById('statVisited').textContent = t.statVisited;
            document.getElementById('statFollowUp').textContent = t.statFollowUp;
            document.getElementById('statNoInterest').textContent = t.statNoInterest;
            document.getElementById('venueTitle').textContent = t.venueTitle;
            document.getElementById('searchInput').placeholder = t.searchPlaceholder;
            
            // Êõ¥Êñ∞Ë°®ÂñÆÊ®ôÁ±§
            document.getElementById('labelName').textContent = t.labelName;
            document.getElementById('labelBooth').textContent = t.labelBooth;
            document.getElementById('labelHall').textContent = t.labelHall;
            document.getElementById('labelCountry').textContent = t.labelCountry;
            document.getElementById('labelCategory').textContent = t.labelCategory;
            document.getElementById('labelWebsite').textContent = t.labelWebsite;
            document.getElementById('labelContact').textContent = t.labelContact;
            document.getElementById('labelAbout').textContent = t.labelAbout;
            document.getElementById('cancelBtn').textContent = t.cancelBtn;
            document.getElementById('saveBtn').textContent = t.saveBtn;
        }

        // Ê∏≤ÊüìÂ†¥È§®ÂàóË°®
        function renderVenueList() {
            const t = translations[currentLang];
            const venueCounts = {};
            
            getAllExhibitors().forEach(ex => {
                const hall = ex.hall || 'Other';
                venueCounts[hall] = (venueCounts[hall] || 0) + 1;
            });

            const sortedVenues = Object.entries(venueCounts)
                .sort((a, b) => b[1] - a[1]);

            let html = `
                <div class="venue-item ${selectedVenue === 'all' ? 'active' : ''}" 
                     onclick="selectVenue('all')">
                    <span>${t.allVenues}</span>
                    <span class="venue-badge">${getAllExhibitors().length}</span>
                </div>
            `;

            sortedVenues.forEach(([venue, count]) => {
                html += `
                    <div class="venue-item ${selectedVenue === venue ? 'active' : ''}" 
                         onclick="selectVenue('${venue.replace(/'/g, "\'")}')">
                        <span>${venue}</span>
                        <span class="venue-badge">${count}</span>
                    </div>
                `;
            });

            document.getElementById('venueList').innerHTML = html;
        }

        // ÈÅ∏ÊìáÂ†¥È§®
        function selectVenue(venue) {
            selectedVenue = venue;
            renderVenueList();
            renderExhibitors();
        }

        // ÂàáÊèõVIPÁãÄÊÖã
        function toggleVIP(id) {
            if (!trackingData[id]) {
                trackingData[id] = { status: '', notes: '', vip: false };
            }
            trackingData[id].vip = !trackingData[id].vip;
            localStorage.setItem('trackingData', JSON.stringify(trackingData));
            renderExhibitors();
            updateStats();
        }

        // Ê∏≤ÊüìÂ±ïÂïÜÂàóË°®
        function renderExhibitors() {
            const t = translations[currentLang];
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            let filtered = getAllExhibitors();

            // Â†¥È§®ÁØ©ÈÅ∏
            if (selectedVenue !== 'all') {
                filtered = filtered.filter(ex => ex.hall === selectedVenue);
            }

            // ÊêúÂ∞ãÁØ©ÈÅ∏
            if (searchTerm) {
                filtered = filtered.filter(ex => 
                    (ex.name && ex.name.toLowerCase().includes(searchTerm)) ||
                    (ex.booth && ex.booth.toLowerCase().includes(searchTerm)) ||
                    (ex.country && ex.country.toLowerCase().includes(searchTerm)) ||
                    (ex.category && ex.category.toLowerCase().includes(searchTerm))
                );
            }

            let html = '';
            filtered.forEach(ex => {
                const tracking = trackingData[ex.id] || { status: '', notes: '', vip: false };
                const isVIP = tracking.vip;
                const isXFactor = ex.hall === 'X-Factor';
                const isCustom = ex.id.toString().startsWith('custom_');
                
                html += `
                    <div class="exhibitor-card ${isVIP ? 'vip' : ''} ${isXFactor ? 'xfactor' : ''}">
                        <div class="exhibitor-header">
                            <div class="exhibitor-info">
                                <div class="exhibitor-name-row">
                                    <button class="star-toggle ${isVIP ? 'active' : ''}" 
                                            onclick="toggleVIP('${ex.id}')"
                                            title="${isVIP ? 'ÂèñÊ∂àÈáçÈªûÂÆ¢Êà∂' : 'Ê®ôË®òÁÇ∫ÈáçÈªûÂÆ¢Êà∂'}">
                                        ${isVIP ? '‚≠ê' : '‚òÜ'}
                                    </button>
                                    <div class="exhibitor-name">${ex.name || ''}</div>
                                    <span class="vip-badge">${t.vipBadge}</span>
                                    <span class="xfactor-badge">${t.xfactorBadge}</span>
                                </div>
                                <div class="exhibitor-details">
                                    ${ex.booth ? `<span>üìç ${t.booth}: ${ex.booth}</span>` : ''}
                                    ${ex.country ? `<span>üåç ${t.country}: ${ex.country}</span>` : ''}
                                    ${ex.category ? `<span>üè∑Ô∏è ${t.category}: ${ex.category}</span>` : ''}
                                </div>
                                ${ex.website ? `<div style="margin-top: 8px;"><a href="${ex.website}" target="_blank" style="color: var(--primary-color); text-decoration: none;">üîó ${ex.website}</a></div>` : ''}
                            </div>
                            <div class="status-selector">
                                <button class="status-btn not-visited ${tracking.status === 'not-visited' ? 'active' : ''}" 
                                        onclick="updateStatus('${ex.id}', 'not-visited')">${t.statusNotVisited}</button>
                                <button class="status-btn visited ${tracking.status === 'visited' ? 'active' : ''}" 
                                        onclick="updateStatus('${ex.id}', 'visited')">${t.statusVisited}</button>
                                <button class="status-btn follow-up ${tracking.status === 'follow-up' ? 'active' : ''}" 
                                        onclick="updateStatus('${ex.id}', 'follow-up')">${t.statusFollowUp}</button>
                                <button class="status-btn no-interest ${tracking.status === 'no-interest' ? 'active' : ''}" 
                                        onclick="updateStatus('${ex.id}', 'no-interest')">${t.statusNoInterest}</button>
                            </div>
                        </div>
                        <div class="notes-section">
                            <textarea 
                                class="notes-input" 
                                placeholder="${t.notesPlaceholder}"
                                onchange="updateNotes('${ex.id}', this.value)"
                            >${tracking.notes || ''}</textarea>
                        </div>
                        ${isCustom ? `
                        <div class="exhibitor-actions">
                            <button class="edit-btn" onclick="editExhibitor('${ex.id}')">${t.editBtn}</button>
                            <button class="delete-btn" onclick="deleteExhibitor('${ex.id}')">${t.deleteBtn}</button>
                        </div>
                        ` : ''}
                    </div>
                `;
            });

            document.getElementById('exhibitorsList').innerHTML = html || `<div class="loading">${t.loadingText}</div>`;
        }

        // ÁØ©ÈÅ∏Â±ïÂïÜ
        function filterExhibitors() {
            renderExhibitors();
        }

        // Êõ¥Êñ∞ÁãÄÊÖã
        function updateStatus(id, status) {
            if (!trackingData[id]) {
                trackingData[id] = { status: '', notes: '', vip: false };
            }
            trackingData[id].status = status;
            localStorage.setItem('trackingData', JSON.stringify(trackingData));
            renderExhibitors();
            updateStats();
        }

        // Êõ¥Êñ∞ÂÇôË®ª
        function updateNotes(id, notes) {
            if (!trackingData[id]) {
                trackingData[id] = { status: '', notes: '', vip: false };
            }
            trackingData[id].notes = notes;
            localStorage.setItem('trackingData', JSON.stringify(trackingData));
        }

        // Êõ¥Êñ∞Áµ±Ë®à
        function updateStats() {
            let visited = 0, followUp = 0, noInterest = 0, vip = 0, xfactor = 0;
            
            const allExhibitors = getAllExhibitors();
            
            Object.values(trackingData).forEach(item => {
                if (item.status === 'visited') visited++;
                else if (item.status === 'follow-up') followUp++;
                else if (item.status === 'no-interest') noInterest++;
                if (item.vip) vip++;
            });

            // Ë®àÁÆó X-Factor Êï∏Èáè
            xfactor = allExhibitors.filter(ex => ex.hall === 'X-Factor').length;

            document.getElementById('totalCount').textContent = allExhibitors.length;
            document.getElementById('vipCount').textContent = vip;
            document.getElementById('xfactorCount').textContent = xfactor;
            document.getElementById('visitedCount').textContent = visited;
            document.getElementById('followUpCount').textContent = followUp;
            document.getElementById('noInterestCount').textContent = noInterest;
        }

        // ÊâìÈñãÊñ∞Â¢ûÂΩàÁ™ó
        function openAddModal() {
            const t = translations[currentLang];
            editMode = false;
            editingId = null;
            document.getElementById('modalTitle').textContent = t.modalTitleAdd;
            clearForm();
            document.getElementById('exhibitorModal').style.display = 'block';
        }

        // Á∑®ËºØÂ±ïÂïÜ
        function editExhibitor(id) {
            const t = translations[currentLang];
            const exhibitor = customExhibitors.find(ex => ex.id === id);
            if (!exhibitor) return;

            editMode = true;
            editingId = id;
            document.getElementById('modalTitle').textContent = t.modalTitleEdit;
            
            // Â°´ÂÖÖË°®ÂñÆ
            document.getElementById('formName').value = exhibitor.name || '';
            document.getElementById('formBooth').value = exhibitor.booth || '';
            document.getElementById('formHall').value = exhibitor.hall || 'X-Factor';
            document.getElementById('formCountry').value = exhibitor.country || '';
            document.getElementById('formCategory').value = exhibitor.category || '';
            document.getElementById('formWebsite').value = exhibitor.website || '';
            document.getElementById('formContact').value = exhibitor.contact || '';
            document.getElementById('formAbout').value = exhibitor.about || '';
            
            document.getElementById('exhibitorModal').style.display = 'block';
        }

        // Âà™Èô§Â±ïÂïÜ
        function deleteExhibitor(id) {
            const t = translations[currentLang];
            if (confirm(t.deleteConfirm)) {
                customExhibitors = customExhibitors.filter(ex => ex.id !== id);
                localStorage.setItem('customExhibitors', JSON.stringify(customExhibitors));
                
                // Âà™Èô§Áõ∏ÈóúËøΩËπ§Êï∏Êìö
                if (trackingData[id]) {
                    delete trackingData[id];
                    localStorage.setItem('trackingData', JSON.stringify(trackingData));
                }
                
                renderVenueList();
                renderExhibitors();
                updateStats();
            }
        }

        // Ê∏ÖÁ©∫Ë°®ÂñÆ
        function clearForm() {
            document.getElementById('formName').value = '';
            document.getElementById('formBooth').value = '';
            document.getElementById('formHall').value = 'X-Factor';
            document.getElementById('formCountry').value = '';
            document.getElementById('formCategory').value = '';
            document.getElementById('formWebsite').value = '';
            document.getElementById('formContact').value = '';
            document.getElementById('formAbout').value = '';
        }

        // ÈóúÈñâÂΩàÁ™ó
        function closeModal() {
            document.getElementById('exhibitorModal').style.display = 'none';
        }

        // ‰øùÂ≠òÂ±ïÂïÜ
        function saveExhibitor() {
            const name = document.getElementById('formName').value.trim();
            if (!name) {
                alert(currentLang === 'zh' ? 'Ë´ãËº∏ÂÖ•Â±ïÂïÜÂêçÁ®±' : 'Please enter exhibitor name');
                return;
            }

            const exhibitorData = {
                id: editMode ? editingId : `custom_${Date.now()}`,
                name: name,
                booth: document.getElementById('formBooth').value.trim(),
                hall: document.getElementById('formHall').value,
                country: document.getElementById('formCountry').value.trim(),
                category: document.getElementById('formCategory').value.trim(),
                website: document.getElementById('formWebsite').value.trim(),
                contact: document.getElementById('formContact').value.trim(),
                about: document.getElementById('formAbout').value.trim(),
                companyInfo: ''
            };

            if (editMode) {
                // Á∑®ËºØÊ®°Âºè
                const index = customExhibitors.findIndex(ex => ex.id === editingId);
                if (index !== -1) {
                    customExhibitors[index] = exhibitorData;
                }
            } else {
                // Êñ∞Â¢ûÊ®°Âºè
                customExhibitors.push(exhibitorData);
            }

            localStorage.setItem('customExhibitors', JSON.stringify(customExhibitors));
            closeModal();
            renderVenueList();
            renderExhibitors();
            updateStats();
        }

        // ÂåØÂá∫Excel
        function exportToExcel() {
            const t = translations[currentLang];
            let csv = currentLang === 'zh' 
                ? 'ID,È°ûÂûã,ÈáçÈªûÂÆ¢Êà∂,ÂêçÁ®±,Â±ï‰Ωç,Â†¥È§®,ÂúãÂÆ∂,È°ûÂà•,Á∂≤Á´ô,ÁãÄÊÖã,ÂÇôË®ª\n'
                : 'ID,Type,VIP Client,Name,Booth,Hall,Country,Category,Website,Status,Notes\n';

            getAllExhibitors().forEach(ex => {
                const tracking = trackingData[ex.id] || { status: '', notes: '', vip: false };
                const vipText = tracking.vip ? (currentLang === 'zh' ? '‚≠ê ÊòØ' : '‚≠ê Yes') : '';
                const typeText = ex.hall === 'X-Factor' ? 'üéØ X-Factor' : (currentLang === 'zh' ? 'ÂéüÂßã' : 'Original');
                const statusText = tracking.status 
                    ? t['status' + tracking.status.split('-').map(w => w[0].toUpperCase() + w.slice(1)).join('')]
                    : '';

                const row = [
                    ex.id,
                    `"${typeText}"`,
                    `"${vipText}"`,
                    `"${(ex.name || '').replace(/"/g, '""')}"`,
                    `"${(ex.booth || '').replace(/"/g, '""')}"`,
                    `"${(ex.hall || '').replace(/"/g, '""')}"`,
                    `"${(ex.country || '').replace(/"/g, '""')}"`,
                    `"${(ex.category || '').replace(/"/g, '""')}"`,
                    `"${(ex.website || '').replace(/"/g, '""')}"`,
                    `"${statusText}"`,
                    `"${(tracking.notes || '').replace(/"/g, '""')}"`
                ];
                csv += row.join(',') + '\n';
            });

            const blob = new Blob(['Ôªø' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `CES2026_Tracking_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // ÈªûÊìäÂΩàÁ™óÂ§ñÈÉ®ÈóúÈñâ
        window.onclick = function(event) {
            const modal = document.getElementById('exhibitorModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // È†ÅÈù¢ËºâÂÖ•ÊôÇÂàùÂßãÂåñ
        // window.onload = loadExhibitorsData; (Â∑≤Âú®‰∏äÊñπÂÆöÁæ©)
    
    // ÂåØÂÖ•ÂäüËÉΩÁõ∏ÈóúËÆäÊï∏
    let importedData = null;
    let originalExhibitorsCount = 0;

    // È°ØÁ§∫ÂåØÂÖ•Ê®°ÊÖãÊ°Ü
    function showImportModal() {
        document.getElementById('importModal').style.display = 'block';
        document.body.classList.add('modal-open');
    }

    // ÈóúÈñâÂåØÂÖ•Ê®°ÊÖãÊ°Ü
    function closeImportModal() {
        document.getElementById('importModal').style.display = 'none';
        document.body.classList.remove('modal-open');
        
        // ÈáçÁΩÆË°®ÂñÆ
        document.getElementById('importFile').value = '';
        document.getElementById('filePreview').style.display = 'none';
        document.getElementById('confirmImport').disabled = true;
        importedData = null;
    }

    // ËôïÁêÜÊ™îÊ°àÈÅ∏Êìá
    function handleFileSelect(event) {
        const file = event.target.files[0];
        if (!file) return;

        const fileName = file.name;
        const fileSize = (file.size / 1024 / 1024).toFixed(2); // MB
        const fileType = file.type;

        console.log(`ÈÅ∏ÊìáÁöÑÊ™îÊ°à: ${fileName} (${fileSize} MB)`);

        // Ê™¢Êü•Ê™îÊ°àÈ°ûÂûã
        const validTypes = [
            'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', // .xlsx
            'application/vnd.ms-excel', // .xls
            'text/csv'
        ];

        if (!validTypes.includes(fileType) && !fileName.match(/\.(xlsx?|csv)$/i)) {
            alert(currentLang === 'zh' ? 'Ë´ãÈÅ∏ÊìáÊúâÊïàÁöÑ Excel Êàñ CSV Ê™îÊ°à' : 'Please select a valid Excel or CSV file');
            return;
        }

        // ËÆÄÂèñÊ™îÊ°à
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                let data;
                
                if (fileName.match(/\.csv$/i)) {
                    // CSV ËôïÁêÜ
                    data = parseCSV(e.target.result);
                } else {
                    // Excel ËôïÁêÜÔºàÈÄôË£°Á∞°ÂåñËôïÁêÜÔºåÂØ¶ÈöõÈúÄË¶ÅÂºïÂÖ• xlsx Â∫´Ôºâ
                    alert(currentLang === 'zh' ? 
                        'Êö´ÊôÇÂÉÖÊîØÊè¥ CSV Ê†ºÂºèÔºåË´ãÂ∞á Excel Ê™îÊ°àÂè¶Â≠òÁÇ∫ CSV ÂæåÈáçÊñ∞ÂåØÂÖ•' : 
                        'Currently only CSV format is supported. Please save Excel as CSV and reimport');
                    return;
                }

                if (data && data.length > 0) {
                    importedData = data;
                    showFilePreview(data, fileName, fileSize);
                    document.getElementById('confirmImport').disabled = false;
                } else {
                    alert(currentLang === 'zh' ? 'Ê™îÊ°àÂÖßÂÆπÁÇ∫Á©∫ÊàñÊ†ºÂºèÈåØË™§' : 'File is empty or format error');
                }

            } catch (error) {
                console.error('Ê™îÊ°àËÆÄÂèñÈåØË™§:', error);
                alert(currentLang === 'zh' ? 'Ê™îÊ°àËÆÄÂèñÂ§±ÊïóÔºåË´ãÊ™¢Êü•Ê™îÊ°àÊ†ºÂºè' : 'File reading failed, please check file format');
            }
        };

        if (fileName.match(/\.csv$/i)) {
            reader.readAsText(file, 'utf-8');
        } else {
            reader.readAsArrayBuffer(file);
        }
    }

    // Ëß£Êûê CSV Ê™îÊ°à
    function parseCSV(csvText) {
        const lines = csvText.split('
');
        const headers = lines[0].split(',').map(h => h.trim().replace(/^"|"$/g, ''));
        const data = [];

        for (let i = 1; i < lines.length; i++) {
            if (lines[i].trim() === '') continue;
            
            const values = parseCSVLine(lines[i]);
            if (values.length === headers.length) {
                const row = {};
                headers.forEach((header, index) => {
                    row[header] = values[index] || '';
                });
                data.push(row);
            }
        }

        return data;
    }

    // Ëß£Êûê CSV Ë°åÔºàËôïÁêÜÂºïËôüÂÖßÁöÑÈÄóËôüÔºâ
    function parseCSVLine(line) {
        const result = [];
        let current = '';
        let inQuotes = false;
        
        for (let i = 0; i < line.length; i++) {
            const char = line[i];
            
            if (char === '"') {
                inQuotes = !inQuotes;
            } else if (char === ',' && !inQuotes) {
                result.push(current.trim().replace(/^"|"$/g, ''));
                current = '';
            } else {
                current += char;
            }
        }
        
        result.push(current.trim().replace(/^"|"$/g, ''));
        return result;
    }

    // È°ØÁ§∫Ê™îÊ°àÈ†êË¶Ω
    function showFilePreview(data, fileName, fileSize) {
        const preview = document.getElementById('filePreview');
        const content = document.getElementById('previewContent');
        
        let previewText = `Ê™îÊ°àÂêçÁ®±: ${fileName}
Ê™îÊ°àÂ§ßÂ∞è: ${fileSize} MB
ÂåØÂÖ•Ë≥áÊñôÁ≠ÜÊï∏: ${data.length}

`;
        previewText += 'Ê¨Ñ‰ΩçÈ†êË¶Ω:
';
        
        if (data.length > 0) {
            const headers = Object.keys(data[0]);
            previewText += headers.join(' | ') + '
';
            previewText += '-'.repeat(50) + '
';
            
            // È°ØÁ§∫Ââç 3 Á≠ÜË≥áÊñô
            for (let i = 0; i < Math.min(3, data.length); i++) {
                const row = headers.map(h => (data[i][h] || '').substring(0, 20)).join(' | ');
                previewText += row + '
';
            }
            
            if (data.length > 3) {
                previewText += `... ÂèäÂÖ∂‰ªñ ${data.length - 3} Á≠ÜË≥áÊñô`;
            }
        }
        
        content.textContent = previewText;
        preview.style.display = 'block';
    }

    // Âü∑Ë°åÂåØÂÖ•
    function executeImport() {
        if (!importedData || importedData.length === 0) {
            alert(currentLang === 'zh' ? 'Ê≤íÊúâÂèØÂåØÂÖ•ÁöÑË≥áÊñô' : 'No data to import');
            return;
        }

        const mergeRecords = document.getElementById('mergeRecords').checked;
        const keepOriginal = document.getElementById('keepOriginal').checked;
        const importNotes = document.getElementById('importNotes').checked;

        // È°ØÁ§∫ÂåØÂÖ•ÈÄ≤Â∫¶
        showImportProgress();

        try {
            const result = processImportData(importedData, {
                mergeRecords,
                keepOriginal,
                importNotes
            });

            // Êõ¥Êñ∞Â±ïÂïÜË≥áÊñô
            if (result.success) {
                // ÈáçÊñ∞ËºâÂÖ•Â±ïÂïÜÂàóË°®
                loadExhibitors();
                updateStats();
                
                alert(currentLang === 'zh' ? 
                    `ÂåØÂÖ•ÂÆåÊàêÔºÅ
ËôïÁêÜÁ≠ÜÊï∏: ${result.processed}
Êñ∞Â¢ûÁ≠ÜÊï∏: ${result.added}
Êõ¥Êñ∞Á≠ÜÊï∏: ${result.updated}` :
                    `Import completed!
Processed: ${result.processed}
Added: ${result.added}
Updated: ${result.updated}`
                );
                
                closeImportModal();
            } else {
                throw new Error(result.error);
            }

        } catch (error) {
            console.error('ÂåØÂÖ•ÈåØË™§:', error);
            alert(currentLang === 'zh' ? 
                `ÂåØÂÖ•Â§±Êïó: ${error.message}` : 
                `Import failed: ${error.message}`
            );
        }
    }

    // È°ØÁ§∫ÂåØÂÖ•ÈÄ≤Â∫¶
    function showImportProgress() {
        // ÈÄôË£°ÂèØ‰ª•Ê∑ªÂä†ÈÄ≤Â∫¶Ê¢ùÈ°ØÁ§∫ÈÇèËºØ
        const confirmBtn = document.getElementById('confirmImport');
        confirmBtn.disabled = true;
        confirmBtn.textContent = currentLang === 'zh' ? 'ÂåØÂÖ•‰∏≠...' : 'Importing...';
    }

    // ËôïÁêÜÂåØÂÖ•Ë≥áÊñô
    function processImportData(data, options) {
        let processed = 0;
        let added = 0;
        let updated = 0;

        try {
            // ÂåØÂÖ•Ë≥áÊñôÊ¨Ñ‰ΩçÂ∞çÊáâ
            const fieldMapping = {
                'Âª†ÂïÜÂêçÁ®±': 'name',
                'Company Name': 'name',
                'ÂêçÁß∞': 'name',
                'Â±ï‰Ωç': 'booth',
                'Booth': 'booth',
                'Á∂≤Á´ô': 'website',
                'Website': 'website',
                'È°ûÂà•': 'category',
                'Category': 'category',
                'ÁãÄÊÖã': 'status',
                'Status': 'status',
                'ÂÇôË®ª': 'notes',
                'Notes': 'notes',
                'VIP': 'vip',
                'ÈáçÈªûÂÆ¢Êà∂': 'vip',
                'ËÅØÁµ°Ë≥áË®ä': 'contact',
                'Contact': 'contact'
            };

            data.forEach(row => {
                processed++;
                
                // ËΩâÊèõË≥áÊñôÊ†ºÂºè
                const exhibitorData = {};
                Object.keys(row).forEach(key => {
                    const mappedKey = fieldMapping[key] || key.toLowerCase();
                    exhibitorData[mappedKey] = row[key];
                });

                // Â∞ãÊâæÊòØÂê¶Â∑≤Â≠òÂú®Áõ∏ÂêåÂª†ÂïÜ
                const existingIndex = exhibitors.findIndex(e => 
                    e.name && exhibitorData.name && 
                    e.name.toLowerCase().trim() === exhibitorData.name.toLowerCase().trim()
                );

                if (existingIndex >= 0) {
                    // Âª†ÂïÜÂ∑≤Â≠òÂú®ÔºåÈÄ≤Ë°åÁñäÂä†ËôïÁêÜ
                    if (options.mergeRecords) {
                        const existing = exhibitors[existingIndex];
                        
                        // ÁñäÂä†ÂÇôË®ª
                        if (options.importNotes && exhibitorData.notes) {
                            const separator = '
--- ÂåØÂÖ•Á¥ÄÈåÑ ' + new Date().toLocaleDateString() + ' ---
';
                            existing.notes = existing.notes ? 
                                existing.notes + separator + exhibitorData.notes : 
                                exhibitorData.notes;
                        }
                        
                        // Êõ¥Êñ∞ÁãÄÊÖãÔºàÂ¶ÇÊûúÂåØÂÖ•Ë≥áÊñôÊúâÁãÄÊÖãÔºâ
                        if (exhibitorData.status && exhibitorData.status !== 'Êú™ÊãúË®™') {
                            existing.status = exhibitorData.status;
                        }
                        
                        // Êõ¥Êñ∞ VIP ÁãÄÊÖã
                        if (exhibitorData.vip === 'ÊòØ' || exhibitorData.vip === 'Yes' || exhibitorData.vip === '‚≠ê') {
                            existing.vip = true;
                        }
                        
                        // Êõ¥Êñ∞ÂÖ∂‰ªñÊ¨Ñ‰ΩçÔºàÂ¶ÇÊûúÂéüÊú¨Ê≤íÊúâÂÄºÔºâ
                        ['booth', 'website', 'category', 'contact'].forEach(field => {
                            if (exhibitorData[field] && !existing[field]) {
                                existing[field] = exhibitorData[field];
                            }
                        });
                        
                        updated++;
                    }
                } else {
                    // Êñ∞Âª†ÂïÜÔºåÁõ¥Êé•Âä†ÂÖ•
                    const newExhibitor = {
                        id: Date.now() + Math.random(), // Ëá®ÊôÇ ID
                        originalId: 'IMPORT_' + Date.now(),
                        name: exhibitorData.name || 'Êú™Áü•Âª†ÂïÜ',
                        booth: exhibitorData.booth || '',
                        hall: 'X-Factor (Ëá™ÂÆöÁæ©)', // ÂåØÂÖ•ÁöÑÂª†ÂïÜÈ†êË®≠ÁÇ∫ X-Factor
                        country: exhibitorData.country || 'Êú™Áü•',
                        category: exhibitorData.category || 'ÂÖ∂‰ªñ',
                        about: exhibitorData.about || '',
                        website: exhibitorData.website || '',
                        contact: exhibitorData.contact || '',
                        companyInfo: exhibitorData.companyInfo || '',
                        status: exhibitorData.status || 'Êú™ÊãúË®™',
                        notes: exhibitorData.notes || '',
                        vip: exhibitorData.vip === 'ÊòØ' || exhibitorData.vip === 'Yes' || exhibitorData.vip === '‚≠ê',
                        isCustom: true
                    };
                    
                    exhibitors.push(newExhibitor);
                    added++;
                }
            });

            // ÂÑ≤Â≠òÂà∞ localStorage
            saveToLocalStorage();

            return {
                success: true,
                processed,
                added,
                updated
            };

        } catch (error) {
            return {
                success: false,
                error: error.message
            };
        }
    }

    // ÊãñÊãΩÂäüËÉΩ
    function setupDragAndDrop() {
        const uploadArea = document.querySelector('.file-upload-area');
        
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, preventDefaults, false);
            document.body.addEventListener(eventName, preventDefaults, false);
        });

        ['dragenter', 'dragover'].forEach(eventName => {
            uploadArea.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, unhighlight, false);
        });

        uploadArea.addEventListener('drop', handleDrop, false);

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        function highlight(e) {
            uploadArea.classList.add('dragover');
        }

        function unhighlight(e) {
            uploadArea.classList.remove('dragover');
        }

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;

            if (files.length > 0) {
                document.getElementById('importFile').files = files;
                handleFileSelect({ target: { files: files } });
            }
        }
    }

    // Âú®È†ÅÈù¢ËºâÂÖ•ÂæåË®≠ÂÆöÊãñÊãΩÂäüËÉΩ
    document.addEventListener('DOMContentLoaded', function() {
        setTimeout(setupDragAndDrop, 1000); // Âª∂ÈÅ≤Á¢∫‰øù DOM ÂÆåÂÖ®ËºâÂÖ•
    });</script>

    <!-- ÂåØÂÖ•Ê®°ÊÖãÊ°Ü -->
    <div id="importModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 data-zh="ÂåØÂÖ•ËøΩËπ§Á¥ÄÈåÑ" data-en="Import Tracking Records">ÂåØÂÖ•ËøΩËπ§Á¥ÄÈåÑ</h2>
                <button class="close-btn" onclick="closeImportModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="import-section">
                    <h3 data-zh="ÈÅ∏ÊìáÂåØÂÖ•Ê™îÊ°à" data-en="Select Import File">ÈÅ∏ÊìáÂåØÂÖ•Ê™îÊ°à</h3>
                    <div class="file-upload-area" onclick="document.getElementById('importFile').click()">
                        <input type="file" id="importFile" accept=".xlsx,.xls,.csv" style="display: none;" onchange="handleFileSelect(event)">
                        <div class="upload-icon">üìÑ</div>
                        <p data-zh="ÈªûÊìäÈÅ∏ÊìáÊ™îÊ°àÊàñÊãñÊãΩËá≥Ê≠§" data-en="Click to select file or drag here">ÈªûÊìäÈÅ∏ÊìáÊ™îÊ°àÊàñÊãñÊãΩËá≥Ê≠§</p>
                        <p class="file-info" data-zh="ÊîØÊè¥ Excel (.xlsx, .xls) Âíå CSV Ê™îÊ°à" data-en="Supports Excel (.xlsx, .xls) and CSV files">ÊîØÊè¥ Excel (.xlsx, .xls) Âíå CSV Ê™îÊ°à</p>
                    </div>
                    <div id="filePreview" style="display: none;">
                        <h4 data-zh="Ê™îÊ°àÈ†êË¶Ω" data-en="File Preview">Ê™îÊ°àÈ†êË¶Ω</h4>
                        <div id="previewContent"></div>
                    </div>
                </div>
                <div class="import-options">
                    <h3 data-zh="ÂåØÂÖ•ÈÅ∏È†Ö" data-en="Import Options">ÂåØÂÖ•ÈÅ∏È†Ö</h3>
                    <label class="checkbox-label">
                        <input type="checkbox" id="mergeRecords" checked>
                        <span data-zh="ÁñäÂä†Âêå‰∏ÄÂª†ÂïÜÁöÑÂ§öÁ≠ÜÁ¥ÄÈåÑ" data-en="Merge records for same exhibitor">ÁñäÂä†Âêå‰∏ÄÂª†ÂïÜÁöÑÂ§öÁ≠ÜÁ¥ÄÈåÑ</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="keepOriginal" checked>
                        <span data-zh="‰øùÁïôÂéüÊúâÁ¥ÄÈåÑ" data-en="Keep original records">‰øùÁïôÂéüÊúâÁ¥ÄÈåÑ</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="importNotes">
                        <span data-zh="ÂåØÂÖ•ÂÇôË®ªÔºà‰ª•ÂàÜÈöîÁ∑öÂçÄÂàÜÔºâ" data-en="Import notes (separated by divider)">ÂåØÂÖ•ÂÇôË®ªÔºà‰ª•ÂàÜÈöîÁ∑öÂçÄÂàÜÔºâ</span>
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeImportModal()" data-zh="ÂèñÊ∂à" data-en="Cancel">ÂèñÊ∂à</button>
                <button id="confirmImport" class="btn-primary" onclick="executeImport()" disabled data-zh="ÈñãÂßãÂåØÂÖ•" data-en="Start Import">ÈñãÂßãÂåØÂÖ•</button>
            </div>
        </div>
    </div>
</body>
</html>